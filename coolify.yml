app:
  name: rasa-chatbot
  services:
    rasa:
      port: 5005
      healthcheck:
        path: /status
        port: 5005
      environment:
        - RASA_ENV=${RASA_ENV:-production}
        - PYTHONUNBUFFERED=1
        - RASA_TELEMETRY_ENABLED=false
        - ACTION_SERVER_URL=${ACTION_SERVER_URL}
      volumes:
        - .:/app:ro
        - ./models:/app/models
      resources:
        limits:
          memory: 2G
        reservations:
          memory: 1G

    actions:
      port: 5055
      healthcheck:
        path: /health
        port: 5055
      environment:
        - RASA_ENV=production
        - PYTHONUNBUFFERED=1
      volumes:
        - .:/app:ro
        - ./models:/app/models
      resources:
        limits:
          memory: 1G
        reservations:
          memory: 512M

  environment:
    - name: OPENAI_API_KEY
      required: true
      secret: true
