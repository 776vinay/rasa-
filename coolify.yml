app:
  name: rasa-chatbot
  services:
    rasa:
      port: 5005
      healthcheck:
        path: /status
        port: 5005
      environment:
        - RASA_ENV=${RASA_ENV:-production}
        - PYTHONUNBUFFERED=1
        - RASA_TELEMETRY_ENABLED=false
        - ACTION_SERVER_URL=https://k0wkcokggwowkkgc8cosw084.bizfloe.com/webhook
        - RASA_MODEL_SERVER=https://p0w8o4w4wk008k40s004swgs.bizfloe.com
        - OPENAI_API_KEY=${OPENAI_API_KEY}
      volumes:
        - .:/app:ro
        - ./models:/app/models
      resources:
        limits:
          memory: 2G
        reservations:
          memory: 1G

    actions:
      port: 5056
      healthcheck:
        path: /health
        port: 5056
      environment:
        - RASA_ENV=production
        - PYTHONUNBUFFERED=1
        - OPENAI_API_KEY=${OPENAI_API_KEY}
        - RASA_SERVER_URL=https://p0w8o4w4wk008k40s004swgs.bizfloe.com
      volumes:
        - .:/app:ro
        - ./models:/app/models
      resources:
        limits:
          memory: 1G
        reservations:
          memory: 512M

  environment:
    - name: OPENAI_API_KEY
      required: true
      secret: true
